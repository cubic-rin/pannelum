<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  


  <title>Pannellum demo</title>

  
  
  
<style>
* { 
  margin: 0; 
  padding: 0;
}

#panorama {
  width: 100vw;
  height: 100vh;
}
	
/* 커스텀 툴팁 스타일 */
.custom-tooltip {
	position: relative;
}
.tooltip-box {
	display: none; /* 처음엔 숨김 */
	position: absolute;
	bottom: 30px;
	left: 50%;
	transform: translateX(-50%);
	background: rgba(0, 0, 0, 0.85);
	color: #fff;
	padding: 10px 14px;
	border-radius: 8px;
	font-size: 13px;
	width: 180px;
	text-align: center;
	z-index: 10;
	white-space: normal;
}
.tooltip-box h4 {
	margin: 0 0 4px;
	font-size: 14px;
	color: #ffd700;
}
/* 활성화 시 표시 */
.tooltip-box.active {
	display: block;
}
/* Pannellum 기본 + 아이콘 살리기 */
.pnlm-hotspot-base.pnlm-hotspot-scene {
	cursor: pointer;
}

	
	
	
	#mini-map {
		position: absolute;
		right: 20px;
		bottom: 20px;
		width: 300px; height: 200px; background: rgba(255,255,255,0.9); border-radius: 10px;
		padding: 8px;
		display: none;
	}
	#mini-map img {
		width: 100%;
		border-radius: 8px;
	}
	.map-point {
		position: absolute;
		width: 12px;
		height: 12px;
		background: #ccc;
		border-radius: 50%;
		cursor: pointer;
		transform: translate(-50%, -50%);
		border: 2px solid #000;
	}
	.map-point.active {
		background: #9c0;
		box-shadow: 0 0 8px gold; pointer-events: none;
	}
	#toggle-map {
		position: absolute;
		right: 20px;
		top: 20px;
		padding: 6px 10px;
		border-radius: 6px;
		background: #fff;
		cursor: pointer;
	}
	.map-point--office { top: 90px; left: 165px; }
	.map-point--meetingroom { top: 30px; right: 20px; }
	
</style>

  <script>
  window.console = window.console || function(t) {};
</script>

  
  
</head>

<body translate="no">
  <!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pannellum demo</title>
    <link rel="stylesheet" href="https://cdn.pannellum.org/2.4/pannellum.css"/>
  </head>
<body>

	<div id="panorama"></div>
	
	<!-- 오버레이 지도 -->
	<div id="mini-map" class="hidden">
		<img src="img/map.svg" alt="Map">
	</div>

	<!-- 지도 ON/OFF 버튼 -->
	<button id="toggle-map">全体地図</button>
	
</body>
</html>
  <script src='https://cdn.pannellum.org/2.4/pannellum.js'></script>
    <script id="rendered-js" >
			"use strict";

const config = {
    autoLoad: true,
    compass: true,
    default: {
        firstScene: "office",
        sceneFadeDuration: 1000
    },
    scenes: {
        office: {
            hfov: 180,
            pitch: 0,
            yaw: 0,
            type: "equirectangular",
            panorama: "img/ph_lake.jpg",
            hotSpots: [
                {
                    pitch: 4,
                    yaw: 21.8,
                    type: "scene",
                    sceneId: "meetingroom"
                },
                {
                    pitch: 5,
                    yaw: 100,
                    type: "info",
                    text: "This is the reception desk area."
                },
                {
                    pitch: -2,
                    yaw: 160,
                    createTooltipFunc: (hotSpotDiv, args) => {
                        hotSpotDiv.classList.add('custom-tooltip');
                        const button = document.createElement('div');
                        button.textContent = '+';
                        Object.assign(button.style, {
                            background: '#ffd700',
                            color: '#000',
                            width: '24px',
                            height: '24px',
                            borderRadius: '50%',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center',
                            cursor: 'pointer',
                            fontWeight: 'bold'
                        });
                        hotSpotDiv.appendChild(button);

                        const popup = document.createElement('div');
                        popup.classList.add('tooltip-box');
                        popup.innerHTML = `
                            <h4>${args.title}</h4>
                            <p>${args.desc}</p>
                        `;
                        hotSpotDiv.appendChild(popup);

                        button.addEventListener('click', (e) => {
                            e.stopPropagation();
                            popup.classList.toggle('active');
                        });

                        document.addEventListener('click', () => {
                            popup.classList.remove('active');
                        });

                        popup.addEventListener('click', (e) => e.stopPropagation());
                    },
                    createTooltipArgs: {
                        title: "Projector",
                        desc: "A 4K projector used for presentations."
                    }
                }
            ]
        },

        meetingroom: {
            hfov: 180,
            pitch: 0,
            yaw: 90,
            type: "equirectangular",
            panorama: "img/ph_building.jpg",
            hotSpots: [
                {
                    pitch: 8,
                    yaw: -58,
                    type: "scene",
                    sceneId: "office"
                }
            ]
        },
    }
};

			"use strict";

// Pannellum 뷰어 초기화
const viewer = pannellum.viewer('panorama', config);

// mini-map 요소
const miniMap = document.getElementById('mini-map');
const toggleMap = document.getElementById('toggle-map');

// 초기에는 지도 숨김
miniMap.style.display = 'none';

// 지도 ON/OFF 버튼
toggleMap.addEventListener('click', () => {
    miniMap.style.display = miniMap.style.display === 'block' ? 'none' : 'block';
});

// -------------------------------
// map-point 자동 생성
// -------------------------------

// 기존 이미지는 유지하므로 innerHTML 초기화 X
Object.keys(config.scenes).forEach(sceneId => {
    const point = document.createElement('div');
    point.classList.add('map-point', `map-point--${sceneId}`); // sceneId 기반 클래스
    point.dataset.scene = sceneId;
//    point.textContent = sceneId; // 필요하면 제거 가능 (아이콘만 쓰고 싶으면)

    // miniMap 안에 append (이미지 위에 올라가도록)
    miniMap.appendChild(point);

    // 클릭 시 scene 이동
    point.addEventListener('click', () => {
        viewer.loadScene(sceneId);

        // active 상태 토글
        document.querySelectorAll('.map-point').forEach(p => p.classList.remove('active'));
        point.classList.add('active');
    });
});

// -------------------------------
// 현재 scene 반영 (초기 상태)
const firstScene = config.default.firstScene;
document.querySelectorAll('.map-point').forEach(p => {
    if (p.dataset.scene === firstScene) p.classList.add('active');
});

// scene 변경 시 active 갱신
viewer.on('scenechange', function(sceneId) {
    document.querySelectorAll('.map-point').forEach(p => {
        p.classList.toggle('active', p.dataset.scene === sceneId);
    });
});

			
  </script>

  
</body>

</html>
